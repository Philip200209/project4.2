{% extends 'base.html' %}
{% block title %}Clients Â· CRIMAP{% endblock %}
{% block content %}
<div class="page-card">
  <div class="header" style="border: none; padding: 0; margin-bottom: 24px;">
    <div>
      <h2><i class="fas fa-address-book"></i> Client Directory</h2>
      <p class="text-muted">Monitor all registered borrowers and their financial snapshots.</p>
    </div>
    <a href="{{ url_for('clients_bp.add_client') }}" class="btn btn-primary">
      <i class="fas fa-user-plus"></i> Add Client
    </a>
  </div>

  {% if clients %}
    <div class="table-wrapper">
      <table class="table table-bordered table-hover">
        <thead>
          <tr>
            <th>Name</th>
            <th>Phone</th>
            <th>Email</th>
            <th>Income</th>
            <th>Credit Score</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for client in clients %}
          <tr>
            <td>{{ client.name }}</td>
            <td>{{ client.phone }}</td>
            <td>{{ client.email }}</td>
            <td>KES {{ client.income }}</td>
            <td>{{ client.credit_score }}</td>
            <td style="display: flex; gap: 8px; flex-wrap: wrap;">
              {% if client.loan_id %}
              <a href="{{ url_for('interventions_bp.log', loan_id=client.loan_id) }}" class="btn btn-warning" style="padding: 8px 14px; color: #1f1b2e;">
                <i class="fas fa-comments"></i>
              </a>
              {% else %}
              <span class="text-muted">No loan</span>
              {% endif %}
              <a href="{{ url_for('clients_bp.edit_client', client_id=client.id) }}" class="btn btn-info" style="padding: 8px 14px;">
                <i class="fas fa-pen"></i>
              </a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="alert alert-info">
      No clients found. <a href="{{ url_for('clients_bp.add_client') }}">Add one now</a>.
    </div>
  {% endif %}
</div>
{% endblock %}
